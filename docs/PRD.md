# PRD: Smart CRM v2.0 — Система управления сферой услуг

> **Версия документа:** 1.0
> **Дата:** 09.02.2026
> **Авторы:** Денис Шиманский (техническая часть), Анна Малафеева (методология)
> **Статус:** Черновик

---

## Содержание

1. [Обзор продукта](#1-обзор-продукта)
2. [Глоссарий](#2-глоссарий)
3. [Карта сущностей](#3-карта-сущностей)
4. [Роли пользователей](#4-роли-пользователей)
5. [User Stories](#5-user-stories)
6. [Функциональные требования](#6-функциональные-требования)
7. [Приоритизация (MVP / v2 / v3)](#7-приоритизация)
8. [План миграции](#8-план-миграции)
9. [Открытые вопросы](#9-открытые-вопросы)

---

## 1. Обзор продукта

### 1.1. Что это

Веб-система управления бизнесом в сфере услуг: детские центры, частные школы, студии (танцы, фитнес, растяжка), салоны красоты, массажные кабинеты и т.д.

Три слоя функциональности:
- **CRM-слой** — воронка продаж, лиды, конверсии, каналы привлечения
- **Операционный слой** — расписание, группы, посещения, абонементы
- **Финансовый слой** — оплаты, расходы, зарплаты, P&L

### 1.2. Предыстория

Система существует с 2023 года на платформе 1С (Smart CRM). 20 клиентов (организаций), ~60-100 конечных пользователей. Модель SaaS, подписка 5-7 тыс. руб./мес.

Причины перезапуска на вебе:
- Сложное внедрение (высокий порог входа для администраторов)
- Дорогая разработка и поддержка на 1С
- Кривая воронка продаж (дубли, некорректные отчёты)
- Невозможность адаптировать под пакетные и разовые услуги

### 1.3. Целевые сроки

| Веха | Дата | Что |
|---|---|---|
| MVP | 1 июня 2026 | Переезд 20 текущих клиентов (календарный абонемент) |
| Обкатка | Июнь-Июль 2026 | Обратная связь, дорихтовка |
| Школы | Август 2026 | Фикс-абонемент для частных школ/садов |
| Расширение | Ноябрь 2026 | Пакетные абонементы (фитнес-студии), разовые услуги |

### 1.4. Критерий успеха

500 000 руб./мес. чистой прибыли.

---

## 2. Глоссарий

> Единые термины для всей команды. Никаких "договоров/интересов лида".

| Термин | Определение | Старый термин в 1С |
|---|---|---|
| **Клиент** | Физическое лицо, которое платит за услуги. В детском центре — родитель. В фитнес-студии — сам посетитель. Центральная сущность системы. | Контрагент, Лид, Плательщик |
| **Подопечный** | Тот, кто получает услугу (если отличается от клиента). В детском центре — ребёнок. Информационная сущность — не участвует в финансовой логике. | Ученик, Ребёнок |
| **Лид** | Клиент на этапе воронки продаж (до первой оплаты абонемента). | Лид |
| **Абонемент** | Предоплата за определённое количество определённых услуг. Привязан к клиенту. Содержит информацию о подопечном, направлении, группе. | Договор, Направление, Интерес лида |
| **Направление** | Тип услуги: "Английский", "Скорочтение", "Стрейчинг", "Массаж". Определяет стоимость занятия. | Направление деятельности |
| **Группа** | Конкретный слот в расписании: направление + кабинет + время + педагог + состав учеников. | Группа обучения |
| **Занятие** | Один конкретный урок/сеанс в расписании. Имеет дату, время, группу, педагога. | Занятие |
| **Посещение** | Факт присутствия или отсутствия клиента/подопечного на занятии. Имеет тип (вид дня). | Посещение, Вид дня |
| **Списание** | Снятие суммы с баланса абонемента клиента за одно занятие (при явке или прогуле). | Списание |
| **Перерасчёт** | Занятие без списания (уважительная причина, справка). Потеря выручки для центра. | Перерасчёт, Неявка уважительная |
| **Филиал** | Физический адрес/локация бизнеса. | Подразделение, Структурная единица |
| **Кабинет** | Помещение внутри филиала, где проводятся занятия. | Кабинет |
| **Педагог** | Сотрудник, проводящий занятия. Имеет ставку. | Преподаватель, Педагог |
| **Оборот** | Сумма всех поступлений денежных средств за период (ДДС). Когда деньги пришли. | Приход |
| **Выручка** | Сумма всех отработанных (списанных) занятий за период. Когда услуга оказана. | Отработанные абонементы, Доход |
| **Финрез** | Финансовый результат: Выручка − Расходы = Прибыль/Убыток. | Финансовый результат |

---

## 3. Карта сущностей

### 3.1. Диаграмма связей

```
Организация (tenant)
├── Филиал (1..N)
│   ├── Кабинет (1..N)
│   ├── Касса (1..N)
│   └── Банковский счёт (0..N)
│
├── Направление (1..N)
│   └── Базовая стоимость занятия
│
├── Сотрудник (1..N)
│   ├── Роль (админ, педагог, руководитель, бухгалтер)
│   └── Ставка ЗП (0..N) — привязана к филиалу + направлению
│
├── Группа (1..N)
│   ├── → Филиал
│   ├── → Кабинет
│   ├── → Направление
│   ├── → Педагог (может меняться)
│   ├── Шаблон расписания (дни, время, длительность)
│   ├── Лимит учеников
│   └── Занятие (генерируется из шаблона)
│       └── Посещение (по каждому ученику)
│           ├── Тип (вид дня)
│           ├── Сумма списания
│           └── Начисление ЗП педагогу
│
├── Клиент (1..N)
│   ├── ФИО, телефон, email, канал привлечения
│   ├── Подопечный (0..N) — информационные поля
│   │   └── Имя, возраст, ДР, доп. поля (произвольные)
│   ├── Абонемент (0..N)
│   │   ├── → Направление
│   │   ├── → Группа
│   │   ├── → Подопечный (опционально)
│   │   ├── Тип (календарный / фикс / пакетный)
│   │   ├── Баланс (сумма на счёте)
│   │   ├── Стоимость занятия (может быть индивидуальной)
│   │   ├── Скидки (0..N)
│   │   └── Статус (активный / приостановлен / закрыт)
│   ├── Статус лида (воронка)
│   │   ├── Новый лид
│   │   ├── Назначено пробное
│   │   ├── Посетил пробное
│   │   ├── Ожидание оплаты
│   │   ├── Активный клиент ← (покидает воронку)
│   │   ├── Потенциал (отложенный)
│   │   ├── Нецелевой
│   │   ├── Чёрный список
│   │   └── Архив
│   ├── Платежи (0..N)
│   └── LTV (рассчитывается)
│
├── Платёж (1..N)
│   ├── Дата
│   ├── Сумма
│   ├── Тип (нал / безнал)
│   ├── → Клиент
│   ├── → Абонемент (опционально)
│   ├── → Касса / Банковский счёт
│   └── Направление (приход / расход / возврат)
│
├── Расход (1..N)
│   ├── Дата
│   ├── Сумма
│   ├── Статья расхода (ДДС)
│   ├── Тип (постоянный / переменный)
│   ├── → Филиал (или все)
│   ├── → Кабинет (или все)
│   ├── → Направление (или все)
│   ├── Период амортизации (опционально)
│   └── → Касса / Банковский счёт
│
├── Скидка (шаблон)
│   ├── Название
│   ├── Тип (постоянная / разовая / связанная)
│   ├── Значение (сумма или %)
│   └── Условие связи (для связанных)
│
├── Статья расхода (справочник)
│   ├── Название
│   └── Тип (постоянный / переменный)
│
└── Вид дня (справочник, настраиваемый)
    ├── Название, сокращение
    ├── Списание с клиента (да/нет)
    ├── Процент списания (0-100%)
    ├── Начисление ЗП педагогу (да/нет)
    └── Цвет
```

### 3.2. Ключевые правила связей

1. **Клиент → Абонементы**: один клиент может иметь N абонементов (разные направления, разные подопечные)
2. **Абонемент → Группа**: один абонемент привязан к одной группе (или нескольким для пакетного типа в v2)
3. **Группа → Педагог**: в каждый момент времени один педагог, но может меняться (замена)
4. **Занятие → Посещения**: одно занятие порождает N посещений (по числу учеников в группе)
5. **Посещение → Списание + ЗП**: каждое посещение (в зависимости от вида дня) может создать списание с абонемента и начисление педагогу
6. **Расход → Распределение**: постоянные расходы автоматически распределяются пропорционально выручке по направлениям/филиалам

---

## 4. Роли пользователей

### 4.1. Руководитель / Собственник

- Полный доступ ко всему
- Настройка системы (филиалы, кабинеты, направления, цены, ставки)
- Финансовые отчёты (P&L, прогноз прибыли, ДДС)
- Управление сотрудниками и правами доступа
- Контроль скидок и корректировок

### 4.2. Администратор

- Работа с воронкой продаж (лиды, пробники, запись)
- Приём оплат
- Внесение расходов (простая форма: сумма + категория + филиал)
- Просмотр должников
- Отметка посещений (если педагог не отмечает)
- Просмотр расписания, загруженности
- **НЕ видит**: зарплаты, финрез, настройки ставок

### 4.3. Педагог

- Просмотр своего расписания и состава групп
- Отметка посещений в своих группах
- Просмотр своей зарплаты (опционально)
- **НЕ видит**: финансы клиентов, других педагогов, отчёты

### 4.4. Бухгалтер

- Разнесение расходов по статьям
- Выплата зарплат
- Закрытие финреза
- Просмотр ДДС, остатков, планов платежей
- **НЕ видит**: воронку продаж, CRM-данные

---

## 5. User Stories

### 5.1. Воронка продаж (CRM-слой)

#### US-001: Создание лида при входящем звонке
**Как** администратор,
**я хочу** быстро внести данные нового клиента при звонке,
**чтобы** не потерять контакт и начать продажу.

**Поля формы:**
- ФИО клиента (родителя) — обязательно
- Телефон — обязательно
- Канал привлечения (откуда узнали) — обязательно
- Желаемое направление — обязательно
- Желаемый филиал — обязательно
- Имя подопечного (ребёнка) — опционально
- Возраст подопечного — опционально
- Комментарий — опционально

**Результат:** Клиент создан в статусе "Новый лид". Появляется в воронке продаж.

---

#### US-002: Назначение пробного занятия
**Как** администратор,
**я хочу** записать лида на пробное занятие в конкретную группу,
**чтобы** он пришёл, попробовал и купил абонемент.

**Действия:**
1. Открыть карточку лида
2. Выбрать группу (система показывает свободные места)
3. Выбрать дату пробного (из расписания группы)
4. Подтвердить запись

**Результат:** Статус лида → "Назначено пробное". Дата пробного видна в карточке и в общем списке. Педагог видит пробника в составе группы на эту дату.

**Автозадача:** За 24 часа до пробного → задача "Отправить напоминание клиенту [ФИО]".

---

#### US-003: Фиксация результата пробного
**Как** администратор,
**я хочу** отметить, что клиент пришёл/не пришёл на пробное,
**чтобы** двигать его по воронке и считать конверсию.

**Варианты:**
- **Пришёл** → статус "Посетил пробное"
- **Не пришёл** → статус остаётся, создаётся задача "Перезвонить [ФИО] — не пришёл на пробное"
- **Отменил** → статус "Потенциал" с комментарием и датой следующего контакта

---

#### US-004: Продажа абонемента
**Как** администратор,
**я хочу** оформить покупку абонемента после пробного,
**чтобы** клиент стал активным и попал в расписание.

**Действия:**
1. Открыть карточку клиента (статус "Посетил пробное")
2. Нажать "Создать абонемент"
3. Выбрать: направление, группа, подопечный (если есть)
4. Система показывает: стоимость занятия, кол-во занятий в текущем месяце, сумму абонемента
5. Применить скидку (опционально)
6. Подтвердить

**Результат:** Абонемент создан. Статус → "Ожидание оплаты". Подопечный добавлен в группу. Занятия в расписании отмечены как "Расписание" (не отмечен).

---

#### US-005: Приём оплаты
**Как** администратор,
**я хочу** внести оплату от клиента,
**чтобы** баланс абонемента обновился и клиент стал активным.

**Действия:**
1. Открыть карточку клиента
2. Нажать "Принять оплату"
3. Ввести сумму
4. Выбрать способ (нал / безнал)
5. Выбрать кассу / счёт
6. Привязать к абонементу (если у клиента несколько)

**Результат:** Баланс абонемента увеличен. Если это первая оплата по абонементу — статус клиента → "Активный клиент" (покидает воронку, переходит в операционный слой).

---

#### US-006: Работа с воронкой (ежедневный ритуал админа)
**Как** администратор,
**я хочу** утром видеть список: кому позвонить, кто идёт на пробное, от кого ждём оплату,
**чтобы** никого не потерять.

**Дашборд "Задачи на сегодня":**
- Лиды с датой связи = сегодня → "Позвонить"
- Пробные назначены на сегодня → "Подтвердить пробное"
- Пробные вчера/позавчера без результата → "Узнать результат пробного"
- Статус "Ожидание оплаты" > 3 дней → "Напомнить об оплате"
- Дни рождения подопечных сегодня → "Поздравить"

Задачи генерируются **автоматически** из дат в карточках клиентов.

---

#### US-007: Управление статусами лида
**Как** администратор,
**я хочу** перевести лида в "потенциал", "нецелевой", "чёрный список" или "архив",
**чтобы** он не засорял рабочий список.

**Статусы воронки:**
| Статус | Описание | Условие перехода |
|---|---|---|
| Новый лид | Первичный контакт | Создание карточки |
| Назначено пробное | Записан на пробное | Администратор назначил дату |
| Посетил пробное | Был на пробном | Отметка посещения |
| Ожидание оплаты | Согласился купить | Администратор перевёл |
| **→ Активный клиент** | Оплатил абонемент | Первая оплата |
| Потенциал | "Позвоните позже" | Администратор + дата связи |
| Нецелевой | Мусорный контакт | Администратор |
| Чёрный список | Запрет на контакт | Администратор |
| Архив | Не дозвонились > N дней | Автоматически / администратор |

---

### 5.2. Операционный слой

#### US-010: Отметка посещений
**Как** педагог (или администратор),
**я хочу** отметить присутствие/отсутствие каждого ученика на занятии,
**чтобы** автоматически рассчитались списания и моя зарплата.

**Действия:**
1. Открыть расписание → выбрать занятие (или перейти из дашборда "Занятия сегодня")
2. Видеть список учеников группы
3. По каждому ученику выбрать вид дня: Явка / Прогул / Перерасчёт / другой настроенный вид
4. Сохранить

**Автоматически:**
- По каждому ученику с видом дня, где "списание = да" → создаётся списание с абонемента (стоимость занятия × % списания)
- По каждому ученику с видом дня, где "ЗП = да" → создаётся начисление педагогу по его ставке
- Неотмеченные ученики остаются в статусе "Расписание" (прогноз)

---

#### US-011: Просмотр расписания
**Как** любой пользователь,
**я хочу** видеть расписание в удобном виде,
**чтобы** понимать, кто где когда занимается.

**Виды:**
- **По кабинетам** (сетка: строки = кабинеты, столбцы = время) — вид "день"
- **По педагогам** (сетка: строки = педагоги, столбцы = время) — вид "день"
- **По группам** (список групп с расписанием на неделю/месяц)
- **Календарь на месяц** (обзорный вид)

**Цветовая индикация заполняемости:**
- Зелёный: 100% мест занято
- Жёлтый: 51-99%
- Голубой: < 50%
- Серый: нет учеников

---

#### US-012: Создание и настройка группы
**Как** руководитель,
**я хочу** создать группу с расписанием,
**чтобы** в неё можно было записывать учеников.

**Поля:**
- Название (подробное: "Англ. 3 класс пн/ср 15:00")
- Направление
- Филиал
- Кабинет
- Педагог
- Лимит учеников
- Шаблон расписания: дни недели + время начала + длительность (мин)
- Срок действия (бессрочная или с датами начала/конца)

**Результат:** Из шаблона автоматически генерируются занятия в расписание на указанный период.

---

#### US-013: Замена педагога в группе
**Как** руководитель или администратор,
**я хочу** заменить педагога в группе (разово или постоянно),
**чтобы** зарплата начислялась корректно новому педагогу.

**Варианты:**
- **Разовая замена**: на конкретное занятие. ЗП за это занятие → заменяющему.
- **Постоянная замена**: с определённой даты. Все будущие занятия → новому педагогу.

---

#### US-014: Создание абонемента (календарный тип)
**Как** администратор,
**я хочу** создать клиенту абонемент на месяц,
**чтобы** система рассчитала стоимость и отслеживала посещения.

**Логика календарного абонемента:**
1. Берётся базовая стоимость занятия по направлению
2. Считается количество занятий в группе за месяц (из расписания)
3. Стоимость абонемента = стоимость × кол-во занятий
4. Применяются скидки (если есть)
5. Каждое посещённое занятие → списание стоимости одного занятия

**Пример:** Английский, пн/ср, 8 занятий в марте, 500 руб./занятие → абонемент = 4 000 руб.

---

### 5.3. Финансовый слой

#### US-020: Внесение расхода (простая форма для админа)
**Как** администратор,
**я хочу** быстро внести расход (купили шоколадки для отзывов),
**чтобы** бухгалтерия была в курсе.

**Форма (максимально простая):**
1. Сумма — ввести число
2. Статья расхода — выбрать из списка (хозтовары, канцелярия, маркетинг...)
3. Филиал — выбрать (или "все")
4. Оплачено из — выбрать кассу / счёт
5. Комментарий — опционально

**Больше ничего.** Постоянный/переменный, период амортизации, направление — это настраивает руководитель/бухгалтер потом (или прописано в настройках статьи).

---

#### US-021: Просмотр должников
**Как** администратор,
**я хочу** видеть, кто не заплатил,
**чтобы** звонить и напоминать.

**Таблица должников:**
- Клиент (ФИО)
- Абонемент (направление + подопечный)
- Плановый долг (если посетит все занятия)
- Фактический долг (по уже отмеченным)
- Дата последней оплаты
- Обещанная дата оплаты (поле для админа)
- Комментарий
- Группа

**Фильтры:** по филиалу, направлению, статусу (актив / отчислен), сумме долга.

**Автозадача:** Если обещанная дата оплаты = сегодня → задача "Позвонить [ФИО] — обещал оплатить".

---

#### US-022: Закрытие финреза (месяц)
**Как** руководитель / бухгалтер,
**я хочу** увидеть финансовый результат за месяц,
**чтобы** понять прибыльность бизнеса.

**Два формата отчёта:**

**Формат A — общий P&L (для собственника):**
```
Выручка (отработанные абонементы):     500 000
─────────────────────────────────────────────
Расходы:
  Зарплата педагогов:                 -150 000
  Аренда:                             -80 000
  Интернет, связь:                     -5 000
  Канцелярия:                         -10 000
  Маркетинг:                          -30 000
  Прочее:                             -15 000
─────────────────────────────────────────────
Итого расходы:                       -290 000
─────────────────────────────────────────────
Чистая прибыль:                       210 000
Маржа:                                    42%
```

**Формат B — по направлениям/филиалам (для управленческих решений):**
```
                   Англ.  Скорочт.  Развивайка  Итого
Выручка:           200к    180к       120к       500к
ЗП педагога:       -60к    -50к       -40к      -150к
Расходы (доля):    -56к    -50к       -34к      -140к
─────────────────────────────────────────────────────
Прибыль:            84к     80к        46к       210к
```

Постоянные расходы (аренда, интернет и т.д.) распределяются пропорционально выручке направления.

---

#### US-023: Прогноз зарплаты педагогов
**Как** руководитель,
**я хочу** видеть, сколько начислено и сколько осталось выплатить каждому педагогу,
**чтобы** планировать выплаты.

**Таблица:**
- Педагог
- Начислено за месяц (по отмеченным занятиям)
- Премии
- Штрафы
- Выплачено
- Осталось выплатить = Начислено + Премии − Штрафы − Выплачено

**Детализация:** клик по сумме → список занятий с расшифровкой (дата, группа, кол-во учеников, ставка, сумма).

---

#### US-024: Выплата зарплаты
**Как** руководитель / бухгалтер,
**я хочу** провести выплату педагогу,
**чтобы** система знала остаток к выплате.

**Действия:**
1. Выбрать педагога
2. Ввести сумму выплаты
3. Выбрать способ (нал / безнал) и кассу / счёт
4. Подтвердить

**Результат:** Создаётся расход (статья "Зарплата педагогов"), привязанный к педагогу, автоматически относится на его филиал/направления.

---

### 5.4. Настройки и администрирование

#### US-030: Первичная настройка организации
**Как** новый клиент системы,
**я хочу** быстро настроить систему под свой центр,
**чтобы** начать работать.

**Пошаговый мастер (wizard):**

| Шаг | Что | Время |
|---|---|---|
| 1 | Создать филиал(ы): название, адрес, часы работы | 2 мин |
| 2 | Создать кабинеты: название, привязка к филиалу | 2 мин |
| 3 | Создать направления: название, стоимость занятия, стоимость пробного | 5 мин |
| 4 | Создать сотрудников: ФИО, роль, контакты | 5 мин |
| 5 | Настроить ставки ЗП педагогов | 10 мин |
| 6 | Создать группы с расписанием | 15 мин |
| 7 | Создать кассы / счета | 2 мин |
| 8 | Настроить статьи расходов (предзаполнены, можно добавить) | 3 мин |

**Целевое время:** ~45 минут от регистрации до рабочей системы.
Текущее время в 1С: несколько часов + сопровождение специалиста.

---

## 6. Функциональные требования

### 6.1. Модуль CRM (воронка продаж)

| ID | Требование | Приоритет |
|---|---|---|
| CRM-01 | Карточка клиента: ФИО, телефон, email, канал привлечения, дата создания, комментарии | MVP |
| CRM-02 | Подопечные (дети): имя, возраст, ДР, произвольные инфо-поля. Не участвуют в финансовой логике | MVP |
| CRM-03 | Статусы воронки: новый лид → назначено пробное → посетил → ожидание оплаты → активный. Плюс: потенциал, нецелевой, ЧС, архив | MVP |
| CRM-04 | Дата следующего контакта — отдельное поле, генерирует задачу | MVP |
| CRM-05 | Канал привлечения — справочник, выбирается при создании лида | MVP |
| CRM-06 | Автоматические задачи из дат: связь, пробник, оплата, ДР | MVP |
| CRM-07 | Фильтрация воронки: по статусу, филиалу, направлению, дате, менеджеру | MVP |
| CRM-08 | Защита от дублей: предупреждение при совпадении телефона | MVP |
| CRM-09 | Объединение дубликатов (с превью, что будет объединено) | MVP |
| CRM-10 | Отчёт "Воронка продаж": текущий месяц + перетекающие с прошлого | MVP |
| CRM-11 | Отчёт "Конверсия пробных по педагогам" | MVP |
| CRM-12 | Отчёт "Лиды по каналам и менеджерам" | MVP |
| CRM-13 | Отчёт "Доходимость" (по дате создания лида: создан → записан → пришёл → купил → оплатил) | MVP |
| CRM-14 | Сегментация клиентов (авто, по правилам: кол-во занятий, сумма, срок) | v2 |

### 6.2. Модуль "Расписание и группы"

| ID | Требование | Приоритет |
|---|---|---|
| SCH-01 | Иерархия: Филиал → Кабинет → Группа | MVP |
| SCH-02 | Группа: название, направление, кабинет, педагог, лимит учеников, шаблон (дни + время + длительность) | MVP |
| SCH-03 | Генерация занятий из шаблона на период (месяц) | MVP |
| SCH-04 | Просмотр расписания: по кабинетам (день), по педагогам (день), по группам (неделя/месяц) | MVP |
| SCH-05 | Цветовая индикация заполняемости групп | MVP |
| SCH-06 | Запись ученика в группу (из абонемента) | MVP |
| SCH-07 | Перевод ученика между группами | MVP |
| SCH-08 | Замена педагога (разовая / постоянная) | MVP |
| SCH-09 | Отмена / удаление занятия | MVP |
| SCH-10 | Индивидуальные занятия (группа с 1 учеником) | MVP |
| SCH-11 | Разовые занятия / мастер-классы | MVP |
| SCH-12 | Лист ожидания: запись лида на ожидание места в группе, уведомление при освобождении | v2 |
| SCH-13 | Массовое копирование расписания с месяца на месяц | MVP |
| SCH-14 | Настройка посещения (1 раз в неделю при 2 занятиях группы) | MVP |

### 6.3. Модуль "Посещения"

| ID | Требование | Приоритет |
|---|---|---|
| ATT-01 | Виды дней: настраиваемый справочник (название, сокращение, списание да/нет, % списания, ЗП да/нет, цвет) | MVP |
| ATT-02 | Предустановленные виды: Явка, Прогул, Перерасчёт (неявка уважительная), Расписание (не отмечен) | MVP |
| ATT-03 | Отметка посещений: экран группы → список учеников → выбор вида дня | MVP |
| ATT-04 | Автоматическое списание с абонемента при отметке (по настройкам вида дня) | MVP |
| ATT-05 | Автоматическое начисление ЗП педагогу при отметке | MVP |
| ATT-06 | Контроль неотмеченных: отчёт "Пропуски" — занятия прошли, но не отмечены | MVP |
| ATT-07 | Отчёт "Потенциальный отток": 3+ прогула подряд без явки | MVP |

### 6.4. Модуль "Абонементы"

| ID | Требование | Приоритет |
|---|---|---|
| SUB-01 | Тип "Календарный": N занятий/мес по расписанию. Стоимость = стоимость занятия × кол-во занятий в месяце | MVP |
| SUB-02 | Баланс абонемента: пополняется оплатой, уменьшается списаниями | MVP |
| SUB-03 | Индивидуальная стоимость занятия (если отличается от базовой по направлению) | MVP |
| SUB-04 | Скидки: постоянные, разовые, связанные. Уведомление при нарушении условия связанной | MVP |
| SUB-05 | Отчисление: ручное (с выбором причины оттока). Остаток на балансе сохраняется | MVP |
| SUB-06 | Перенос баланса: между абонементами одного клиента | MVP |
| SUB-07 | Тип "Фикс": фиксированная сумма/мес + переменная часть (питание) по календарке | v1.1 (авг) |
| SUB-08 | Тип "Пакетный": N занятий за период (не привязан к месяцу), запись на любое занятие, срок действия | v2 (ноябрь) |
| SUB-09 | Разовая услуга: без абонемента, оплата за одно посещение | v2 |

### 6.5. Модуль "Финансы"

| ID | Требование | Приоритет |
|---|---|---|
| FIN-01 | Приём оплат: сумма, способ (нал/безнал), касса/счёт, привязка к абонементу | MVP |
| FIN-02 | Внесение расходов: простая форма (сумма, статья, филиал, касса) | MVP |
| FIN-03 | Статьи расхода: преднастроенный справочник + возможность добавления. Каждая статья — постоянная или переменная | MVP |
| FIN-04 | Отчёт "Должники": плановый долг, фактический долг, обещанная дата оплаты | MVP |
| FIN-05 | Отчёт "Оплаты": баланс на начало, абонемент, оплачено, баланс на конец, дата оплаты, способ | MVP |
| FIN-06 | Отчёт "ДДС" (движение денежных средств): приход/расход за период по статьям | MVP |
| FIN-07 | Отчёт "Остаток денег": текущее состояние касс и счетов | MVP |
| FIN-08 | Отчёт "Ожидаемые поступления": сумма абонементов − оплаченное = сколько ждём | MVP |
| FIN-09 | Отчёт "Отработанные абонементы" (выручка): сумма списаний за месяц | MVP |
| FIN-10 | Отчёт "Прогноз прибыли": сумма абонементов − прогноз ЗП − план постоянных платежей | MVP |
| FIN-11 | Планы платежей: ввод плановых расходов по статьям на месяц, копирование с прошлого месяца | MVP |
| FIN-12 | Финрез (формат A — общий P&L): выручка − расходы = прибыль | MVP |
| FIN-13 | Финрез (формат B — по направлениям): с распределением постоянных расходов пропорционально выручке | MVP |
| FIN-14 | Распределение постоянных расходов: автоматическое, пропорционально выручке по направлениям. Для расходов на конкретный кабинет — пропорционально выручке направлений в этом кабинете | MVP |
| FIN-15 | Амортизация крупных покупок: распределение на N месяцев (срок гарантии/использования) | v2 |
| FIN-16 | Отчёт "Поступления по дням": ежедневные приходы в разрезе нал/безнал | v2 |
| FIN-17 | Отчёт "% распределения финреза": доля каждой статьи от выручки | v2 |
| FIN-18 | Отчёт "ROMI": доходы от лидов по каналам − расходы на канал | v2 |
| FIN-19 | Отчёт "Доход от новых / упущенный доход по отчисленным" | v2 |
| FIN-20 | Интеграция с эквайрингом (ЮKassa / Робокасса) | v2 |

### 6.6. Модуль "Зарплата"

| ID | Требование | Приоритет |
|---|---|---|
| SAL-01 | Ставки ЗП: 4 формата — за ученика, за занятие, за занятие с диапазонами, оклад | MVP |
| SAL-02 | Привязка ставки к: педагог + филиал + направление + дата начала | MVP |
| SAL-03 | Автоматическое начисление при отметке посещений | MVP |
| SAL-04 | Начислено / Выплачено / Осталось — сводка по каждому педагогу | MVP |
| SAL-05 | Проведение выплаты (создаёт расход) | MVP |
| SAL-06 | Премии и штрафы (ручной ввод с комментарием) | MVP |
| SAL-07 | Детализация начислений: до каждого занятия | MVP |
| SAL-08 | Отчёт "Часы педагогов по дням" | v2 |
| SAL-09 | Отчёт "Средняя ЗП педагогов" (ЗП / часы) | v2 |
| SAL-10 | Отчёт "Прогноз сдельной оплаты" (на основании расписания и ставок) | v2 |
| SAL-11 | Оплата пробных занятий педагогам (настройка: да/нет) | MVP |

### 6.7. Модуль "Дашборд и задачи"

| ID | Требование | Приоритет |
|---|---|---|
| DSH-01 | Начальная страница: настраиваемые виджеты (пробники сегодня, должники, ожидаемые оплаты, потенциальный отток, ДР) | MVP |
| DSH-02 | Задачи: ручное создание (разовые) | MVP |
| DSH-03 | Задачи: автоматическое создание из дат (связь, пробник, оплата, ДР) | MVP |
| DSH-04 | Задачи: циклические (шаблоны по расписанию: еженедельно, ежемесячно) | v2 |
| DSH-05 | Фильтрация задач: на сегодня / будущие / выполненные | MVP |

### 6.8. Настройки и администрирование

| ID | Требование | Приоритет |
|---|---|---|
| ADM-01 | Мультитенантность: каждая организация — изолированная среда | MVP |
| ADM-02 | Мультифилиальность: несколько филиалов в одной организации | MVP |
| ADM-03 | Роли и права доступа: руководитель, администратор, педагог, бухгалтер | MVP |
| ADM-04 | Ограничение доступа по филиалам (админ видит только свой филиал) | MVP |
| ADM-05 | Мастер первичной настройки (wizard) | MVP |
| ADM-06 | Справочник "Виды дней" (настраиваемый) | MVP |
| ADM-07 | Справочник "Статьи расхода" (предзаполненный + дополняемый) | MVP |
| ADM-08 | Справочник "Каналы привлечения" (предзаполненный + дополняемый) | MVP |
| ADM-09 | Производственный календарь (праздники, нерабочие дни) | MVP |
| ADM-10 | Импорт клиентов из CSV/Excel (с нормализацией и дедупликацией) | MVP |
| ADM-11 | Аудит действий: кто, когда, что изменил (особенно скидки, корректировки стоимости) | MVP |

---

## 7. Приоритизация

### 7.1. MVP (к 1 июня 2026)

**Цель:** переехать 20 текущих клиентов с календарным абонементом.

**Модули:**
- CRM: воронка полного цикла (лид → активный клиент)
- Справочники: филиалы, кабинеты, направления, сотрудники, виды дней
- Расписание: группы, занятия, отметка посещений
- Абонементы: календарный тип, скидки (3 типа), баланс
- Финансы: оплаты, расходы (простая форма), должники, ДДС, остатки, прогноз прибыли, финрез (оба формата)
- Зарплата: ставки (4 формата), начисления, выплаты, премии/штрафы
- Дашборд: виджеты, задачи (ручные + автоматические)
- Администрирование: мультитенант, роли, wizard, импорт

**Всего требований MVP:** ~70

### 7.2. v1.1 (Август 2026)

**Цель:** подключить частные школы.

- Тип абонемента "Фикс" (фиксированная сумма + переменная часть)
- Доработки по обратной связи от первых клиентов

### 7.3. v2 (Ноябрь 2026)

**Цель:** выход на фитнес/спорт/салоны.

- Тип абонемента "Пакетный" (N занятий за период, запись на любое)
- Разовые услуги (без абонемента)
- Онлайн-запись (виджет на сайт + личный кабинет клиента)
- Уведомления (SMS / Telegram / WhatsApp)
- Мобильная адаптация
- Интеграция с эквайрингом
- Расширенные отчёты (ROMI, часы педагогов, средняя ЗП, амортизация)
- Сегментация клиентов
- Лист ожидания
- Склад/канцтовары

### 7.4. v3 (2027)

- Интеграции (телефония, бухгалтерия, мессенджеры)
- API для внешних систем
- Автоматизация маркетинга (рассылки, цепочки)
- Документооборот (договоры, акты, чеки)
- BI-дашборды для собственников сетей
- Мобильное приложение (нативное)

---

## 8. План миграции

### 8.1. Что переносим

| Данные | Источник | Формат | Обработка |
|---|---|---|---|
| Клиенты (родители) | Выгрузка из 1С | CSV/Excel | Нормализация: дедупликация по телефону, очистка ФИО, структурирование (родитель → подопечные) |
| Остатки балансов | Выгрузка из 1С | CSV | Загрузка в абонементы: долг/переплата по каждому клиенту-направлению |
| Остатки денег | Ручной ввод | — | Начальные остатки касс и счетов |

### 8.2. Что НЕ переносим (вводится заново)

- Педагоги и сотрудники (< 20, руками)
- Расписание (создаётся заново — удобный момент: начало учебного года)
- История оплат и посещений (не нужна для работы)
- Воронка продаж / конверсии (начинаем с чистого листа)
- Склад (при реализации — ревизия + ручной ввод)

### 8.3. Процесс переезда

| Этап | Когда | Что |
|---|---|---|
| 1. Предупреждение | 20 мая | Письмо клиентам: "через месяц переезжаем, новеньких заводите в новую систему" |
| 2. Настройка | 20-31 мая | Клиенты настраивают справочники в новой системе (wizard + видеоинструкция) |
| 3. Импорт | 1-7 июня | Загрузка клиентских баз + остатков |
| 4. Параллельная работа | 1-14 июня | Две недели на адаптацию |
| 5. Отключение 1С | 15 июня | Полный переход |
| 6. Сбор обратной связи | Июнь-Июль | Доработки по реальному использованию |

### 8.4. Логика нормализации при импорте

1. **Дедупликация:** группировка по номеру телефона → все записи с одним телефоном = один клиент
2. **Родитель/Ребёнок:** в 1С запись "Иванов Петя, мама Иванова Мария" → Клиент: Иванова Мария (тел.), Подопечный: Петя
3. **Остатки:** сумма баланса из 1С → начальный баланс абонемента в новой системе. Если долг — отрицательный баланс. Если переплата — положительный
4. **Валидация:** отчёт для клиента: "Вот ваши данные после импорта, проверьте"

---

## 9. Открытые вопросы

| # | Вопрос | Кто решает | Срок |
|---|---|---|---|
| 1 | Ценообразование новой CRM: от филиалов? Тарифы? | Денис + Анна | До апреля |
| 2 | Технологический стек (фронтенд, бэкенд, БД) | Денис | Февраль |
| 3 | Хостинг: облачный провайдер, оценка стоимости | Денис | Февраль |
| 4 | Формат финреза от Наташи (оба варианта) | Анна → Наташа | Февраль |
| 5 | NPS опрос клиентов (что просили, чего не хватает) | Анна | Февраль |
| 6 | CUSTDEV с потенциальными клиентами других сегментов (Левита, школы) | Анна | Март |
| 7 | Юридическая структура: ООО «УмнаяСРМ» — остаётся? Новое юрлицо? | Денис + Анна | Март |
| 8 | Домен: umnayacrm.ru — оставляем? Новый бренд? | Денис + Анна | Март |
| 9 | Дизайн: нанимаем дизайнера или используем UI-kit? | Денис | Февраль |
| 10 | Нужна ли Настя (поддержка) с первого дня или с момента переезда? | Анна | Апрель |

---

> **Следующие шаги:**
> 1. Ревью PRD с Анной — согласование терминов и приоритетов
> 2. Выбор технологического стека
> 3. Проектирование схемы БД
> 4. UI/UX: wireframes ключевых экранов
> 5. Начало разработки MVP
